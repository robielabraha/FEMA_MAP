<!doctype html>
<html>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Map of Total FEMA Applications and Social Vulnerability</title>
<link rel=stylesheet href=https://unpkg.com/leaflet@1.2.0/dist/leaflet.css crossorigin=""/>
<script src=https://unpkg.com/leaflet@1.2.0/dist/leaflet-src.js crossorigin></script>
<script src=https://s3.amazonaws.com/robielmap/FEMA/leaflet-gplaces-autocomplete.js></script>
<link rel="stylesheet"href=https://s3.amazonaws.com/robielmap/FEMA/leaflet-gplaces-autocomplete.css />
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDhmJd5hn5PKjidZHcjpagRd-9KpGU4yh4&libraries=places"></script>
<script src=https://s3.amazonaws.com/robielmap/femadata.js></script>
<style type=text/css>html,body{width:100%;height:100%;margin:0}#map1,#map2{width:49.5%;height:100%}#map1{float:left}#map2{float:right}.info{padding:2px 4px;font:11px Arial,Helvetica,sans-serif;background:white;background:rgba(255,255,255,1);box-shadow:0 0 15px rgba(0,0,0,0.2);border-radius:5px}.info h4{margin:0 0 2px;color:'black'}.legend{line-height:12px;color:#000}.legend i{width:12px;height:12px;float:left;margin-right:5px;opacity:1}</style>
</head>
<body>
<div id=map1></div>
<div id=map2></div>
<script src=https://s3.amazonaws.com/robielmap/FEMA/L.Map.Sync.js></script>
<script type=text/javascript>var center=[29.760427,-95.369803];var layer1=L.tileLayer("https://api.mapbox.com/styles/v1/robielabraha/cjflc4lc21e2k2spftcf0qxro/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1Ijoicm9iaWVsYWJyYWhhIiwiYSI6ImNpcDc0b3lpZTAwZDdlYW5yMG1oN3FrbXgifQ.DYeYss9VRBUIoUVxfATxxQ");var layer2=L.tileLayer("https://api.mapbox.com/styles/v1/robielabraha/cjflcare81itu2rnxyupnm0yg/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1Ijoicm9iaWVsYWJyYWhhIiwiYSI6ImNpcDc0b3lpZTAwZDdlYW5yMG1oN3FrbXgifQ.DYeYss9VRBUIoUVxfATxxQ",{attribution:'Map designed by <a href="http://www.episcopalhealth.org/en/research/hurricane-harvey-recovery-resources/">Episcopal Health Foundation</a>, Application Data Source: <a href="https://www.fema.gov/openfema">FEMA</a>, SVI Data Source: <a href="https://svi.cdc.gov/">CDC</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>',});var layer3=L.tileLayer("https://api.mapbox.com/styles/v1/robielabraha/cjflckqbbg0mw2rk9txovtljk/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1Ijoicm9iaWVsYWJyYWhhIiwiYSI6ImNpcDc0b3lpZTAwZDdlYW5yMG1oN3FrbXgifQ.DYeYss9VRBUIoUVxfATxxQ");var map1=L.map("map1",{layers:[layer1],center:center,zoomSnap:0.1,zoom:14});map1.attributionControl.setPrefix("");var map2=L.map("map2",{layers:[layer2],center:center,zoomSnap:0.1,zoom:14,zoomControl:false});map1.sync(map2);map2.sync(map1);new L.Control.GPlaceAutocomplete({position:"topleft"}).addTo(map1);var baseMaps={"Percent of Applications Approved":layer3,"Total FEMA Applications":layer1};L.control.layers(baseMaps,null,{position:"topleft"}).addTo(map1);function getColor(a){return a>1000?"#993404":a>500?"#d95f0e":a>250?"#fe9929":a>100?"#fec44f":a>50?"#fee391":"#ffffd4"}function style(a){return{fillColor:getColor(a.properties.SUBMITTED),weight:2,opacity:0,color:"white",dashArray:"3",fillOpacity:0}}function getColor2(a){return a=="High Vulnerability"?"#cb181d":a=="Moderately High Vulnerability"?"#fb6a4a":a=="Moderately Low Vulnerability"?"#fcae91":a=="Low Vulnerability"?"#fee5d9":"#D3D3D3"}function style2(a){return{fillColor:getColor2(a.properties.Vulnerabil),weight:2,opacity:0,color:"white",dashArray:"3",fillOpacity:0}}function getColor3(a){return a>64?"#253494":a>50?"#2c7fb8":a>35?"#41b6c4":a>20?"#a1dab4":"#ffffcc"}function style3(a){return{fillColor:getColor3(a.properties.TOTALAPPLI),weight:2,opacity:0,color:"white",dashArray:"3",fillOpacity:0}}var info=L.control();info.onAdd=function(a){this._div=L.DomUtil.create("div","info");this.update();return this._div};info.update=function(a){this._div.innerHTML="<h4>Total Number of </h4><h4>FEMA Applications</h4>"+(a?"<i>Block Group: "+a.BLKGRPCE+"</i></b><br /><i>Census Tract: "+a.TRACTCE+"</i></b><br /></b><br /><b>"+a.SUBMITTED+"</b> applications</b><br /> from this area were</b><br />submitted to FEMA":"Hover over the map</b><br />to reveal FEMA</b><br />application data for</b><br />that census block group")};info.addTo(map1);var info2=L.control();info2.onAdd=function(a){this._div=L.DomUtil.create("div","info");this.update();return this._div};info2.update=function(a){this._div.innerHTML="<h4>The Social Vulnerability Index (SVI)</h4>"+(a?"<i>Block Group: "+a.BLKGRPCE+"</i></b><br /><i>Census Tract: "+a.TRACTCE+"</i></b><br /></b><br />In terms of social vulnerability this area</b><br />has <b>"+a.Vulnerabil+"</b>":"Hover over the map to reveal SVI</b><br />index information for a local area")};info2.addTo(map2);var info3=L.control();info3.onAdd=function(a){this._div=L.DomUtil.create("div","info");this.update();return this._div};info3.update=function(a){this._div.innerHTML="<h4>FEMA Applications</h4><h4>Approval Rate</h4>"+(a?"<i>Block Group: "+a.BLKGRPCE+"</i></b><br /><i>Census Tract: "+a.TRACTCE+"</i></b><br /></b><br /><b>"+a.APPROVAL+"</b> of applications</b><br /> from this area were</b><br /> approved by FEMA</b><br /><i>Total Applications: <b>"+a.SUBMITTED+"</b></b><br />Total Approved: <b>"+a.APPROVED+"</b></i>":"Hover over the map</b><br />to reveal FEMA</b><br />application data for</b><br />that census block group")};function highlightFeature(b){var a=b.target;a.setStyle({weight:2,fillColor:"#000000",color:"#000000",dashArray:"5",opacity:1,fillOpacity:0.3});if(!L.Browser.ie&&!L.Browser.opera&&!L.Browser.edge){a.bringToFront()}info.update(a.feature.properties);info2.update(a.feature.properties);info3.update(a.feature.properties)}function resetHighlight(a){geojson.resetStyle(a.target);info.update();info2.update();info3.update()}function zoomToFeature(a){map.fitBounds(a.target.getBounds())}function onEachFeature(b,a){a.on({mouseover:highlightFeature,mouseout:resetHighlight,click:zoomToFeature})}var geojson=L.geoJson(femaData,{style:style,onEachFeature:onEachFeature}).addTo(map1);var geojson2=L.geoJson(femaData,{style:style,onEachFeature:onEachFeature}).addTo(map2);var Legend=L.control({position:"bottomright"});Legend.onAdd=function(c){var g=L.DomUtil.create("div","info legend"),a=[0,50,100,250,500,1000],f=["<strong> Total Applications </strong>"],e,d;for(var b=0;b<a.length;b++){e=a[b];d=a[b+1]-1;f.push('<i style="background:'+getColor(a[b]+1)+'"></i> '+e+(d?" to "+d:" or more"))}g.innerHTML=f.join("<br>");return g};var Legend2=L.control({position:"bottomright"});Legend2.onAdd=function(b){var c=L.DomUtil.create("div","info legend");labels=["<strong>Social Vulnerability Index</strong>"],colors=["#cb181d","#fb6a4a","#fcae91","#fee5d9"],categories=["Low Vulnerability","Moderately Low Vulnerability","Moderately High Vulnerability","High Vulnerability"];for(var a=0;a<categories.length;a++){c.innerHTML+=labels.push('<i class="circle" style="background:'+getColor2(categories[a])+'"></i> '+(categories[a]?categories[a]:"+"))}c.innerHTML=labels.join("<br>");return c};Legend.addTo(map1);Legend2.addTo(map2);var Legend3=L.control({position:"bottomright"});Legend3.onAdd=function(c){var g=L.DomUtil.create("div","info legend"),a=[0,20,35,50,65],f=["<strong> Percent Approved </strong>"],e,d;for(var b=0;b<a.length;b++){e=a[b];d=a[b+1]-1;f.push('<i style="background:'+getColor3(a[b]+1)+'"></i> '+e+(d?"% to "+d+"%":"% or more"))}g.innerHTML=f.join("<br>");return g};map1.on("baselayerchange",function(a){if(a.name==="Percent of Applications Approved"){map1.removeControl(Legend);Legend3.addTo(map1);map1.removeControl(info);info3.addTo(map1)}else{map1.removeControl(Legend3);Legend.addTo(map1);map1.removeControl(info3);info.addTo(map1)}});</script>
</body>
</html>